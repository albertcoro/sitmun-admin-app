{"version":3,"sources":["../../../node_modules/tslib/tslib.es6.js","../../src/main/angular-library/projects/sitmun-frontend-gui/src/lib/btn-edit-rendered/btn-edit-rendered.component.ts","../../src/main/angular-library/projects/sitmun-frontend-gui/src/lib/btn-checkbox-rendered/btn-checkbox-rendered.component.ts","../../src/main/angular-library/projects/sitmun-frontend-gui/src/lib/btn-checkbox-filter/btn-checkbox-filter.component.ts","../../src/main/angular-library/projects/sitmun-frontend-gui/src/lib/dialog-message/dialog-message.component.ts","../../src/main/angular-library/projects/sitmun-frontend-gui/src/lib/data-grid/data-grid.component.ts","../../../src/main/angular-library/projects/sitmun-frontend-gui/src/lib/material-module.ts","../../src/main/angular-library/projects/sitmun-frontend-gui/src/lib/dialog-grid/dialog-grid.component.ts","../../src/main/angular-library/projects/sitmun-frontend-gui/src/lib/dialog-form/dialog-form.component.ts","../../src/main/angular-library/projects/sitmun-frontend-gui/src/lib/data-tree/data-tree.component.ts","../../../src/main/angular-library/projects/sitmun-frontend-gui/src/lib/sitmun-frontend-gui.module.ts"],"names":["Object","create","__values","o","s","Symbol","iterator","m","i","call","length","next","value","done","TypeError","__read","n","r","e","ar","push","error","BtnEditRenderedComponent","prototype","agInit","params","this","refresh","btnClickedHandler","$event","clicked","getParams","ngOnDestroy","Component","args","selector","template","BtnCheckboxRenderedComponent","invokeParentMethod","context","componentParent","methodFromParent","node","rowIndex","colDef","headerName","btnCheckedHandler","event","checked","target","firstElementChild","colId","column","api","undoRedoService","isFilling","setDataValue","BtnCheckboxFilterComponent","valueGetter","filterParams","suppressFilterButton","isFilterActive","text","doesFilterPass","_this","toLowerCase","split","every","filterWord","toString","indexOf","getModel","setModel","model","onChange","newValue","parentFilterInstance","instance","onFloatingFilterChanged","onParentModelChanged","parentModel","currentValue","filter","host","class","ViewChild","read","ViewContainerRef","DialogMessageComponent","dialogRef","ngOnInit","doAccept","close","closeDialog","MatDialogRef","DataGridComponent","dialog","translate","AllCommunityModules","statusColumn","Map","modificationChange","undoNoChanges","frameworkComponents","btnEditRendererComponent","btnCheckboxRendererComponent","btnCheckboxFilterComponent","remove","EventEmitter","new","add","sendChanges","getSelectedRows","duplicate","getAllRows","changeCounter","previousChangeCounter","redoCounter","gridOptions","defaultColDef","sortable","flex","editable","nonEditable","cellStyle","backgroundColor","suppressMenu","resizable","columnTypes","dateColumn","comparator","filterLocalDateAtMidnight","cellValue","dateCellValue","Date","dateFilter","getTime","rowSelection","singleClickEdit","localeTextFunc","key","defaultValue","data","instant","eventRefreshSubscription","_eventRefreshSubscription","subscribe","changesMap","clear","getElements","eventGetSelectedRowsSubscription","_eventGetSelectedRowsSubscription","emitSelectedRows","eventGetAllRowsSubscription","_eventGetAllRowsSubscription","emitAllRows","eventSaveAgGridStateSubscription","_eventSaveAgGridStateSubscription","saveAgGridState","eventAddItemsSubscription","items","addItems","firstDataRendered","undefined","localStorage","agGridState","JSON","parse","idAgGrid","id","gridApi","setFilterModel","filterState","gridColumnApi","setColumnState","colState","setSortModel","sortState","searchValue","valueSearchGeneric","quickSearch","removeAgGridState","onGridReady","singleSelection","columnApi","console","log","columnDefs","_b","_c","field","defaultColumnSorting","sortModel","sort","selectedData","getSelectedNodes","map","emit","rowData","forEachNode","getColumnState","getFilterModel","getSortModel","setItem","stringify","removeItem","getColumnKeysAndHeaders","columnkeys","header","getAllDisplayedColumns","forEach","element","userProvidedColDef","join","exportData","onlySelected","columnKeys","customHeader","skipHeader","exportDataAsCsv","setQuickFilter","getAll","setRowData","sizeColumnsToFit","newItems","itemsToAdd","item","find","status","updateRowData","removeData","stopEditing","selectedNodes","selectedRows","selectedRows_1","selectedRows_1_1","getRowNode","refreshCells","deselectAll","newData","onAddButtonClicked","onDuplicateButtonClicked","open","componentInstance","title","message","afterClosed","result","applyChanges","itemsChanged","keys","redrawRows","deleteChanges","undo","onFilterModified","undoCellEditing","redo","redoCellEditing","onCellEditingStopped","onCellValueChanged","oldValue","has","get","currentChanges","set","addMap","paintCells","delete","size","row","getDisplayedRowAtIndex","rowNodes","cellRenderer","undoRedoActions","cellValueChanges","pushActionsToUndoStack","modificationWithoutChanges","getColumnIndexByColId","getAllColumns","findIndex","col","getColId","changeCellStyleColumns","color","columnNumber","columnController","gridColumns","MatDialog","TranslateService","Input","Output","NgModule","exports","A11yModule","CdkStepperModule","CdkTableModule","CdkTreeModule","DragDropModule","MatAutocompleteModule","MatBadgeModule","MatBottomSheetModule","MatButtonModule","MatButtonToggleModule","MatCardModule","MatCheckboxModule","MatChipsModule","MatStepperModule","MatDatepickerModule","MatDialogModule","MatDividerModule","MatExpansionModule","MatGridListModule","MatIconModule","MatInputModule","MatListModule","MatMenuModule","MatNativeDateModule","MatPaginatorModule","MatProgressBarModule","MatProgressSpinnerModule","MatRadioModule","MatRippleModule","MatSelectModule","MatSidenavModule","MatSliderModule","MatSlideToggleModule","MatSnackBarModule","MatSortModule","MatTableModule","MatTabsModule","MatToolbarModule","MatTooltipModule","MatTreeModule","PortalModule","ScrollingModule","MatFormFieldModule","DialogGridComponent","Subject","joinTables","tablesReceivedCounter","addButtonClickedSubscription","_addButtonClickedSubscription","getAllSelectedRows","joinRowsReceived","allRowsReceived","getAllsTable","doAdd","rowsToAdd","DialogFormComponent","form","valid","hideCancelButton","expandable","name","level","type","FileDatabase","BehaviorSubject","defineProperty","dataChange","initialize","dataObj","buildFileTree","arrayTreeNodes","treeNode","obj","children","previousChildren","parent","isFolder","deleteItem","deleteNode","nodes","nodeToDelete","index","splice","copyPasteItem","from","to","insertItem","copyPasteItemAbove","insertItemAbove","copyPasteItemBelow","insertItemBelow","getNewItem","active","cartographyId","cartographyName","datasetURL","description","filterGetFeatureInfo","filterGetMap","filterSelectable","metadataURL","order","queryableActive","radio","tooltip","_links","newItem","nodeDrag","parentNode","getParentFromNodes","currentRoot","getParent","child","Injectable","DataTreeComponent","database","SelectionModel","dragging","expandDelay","validateDrop","dragNodeExpandOverWaitTimeMs","existingNode","nestedNodeMap","flatNode","FileFlatNode","flatNodeMap","observableOf","_","_nodeData","emitNode","createNode","createFolder","emitAllNodes","treeFlattener","MatTreeFlattener","transformer","_getLevel","_isExpandable","_getChildren","treeControl","FlatTreeControl","dataSource","MatTreeFlatDataSource","eventNodeUpdatedSubscription","updateNode","eventCreateNodeSubscription","createNewFolder","createNewNode","treeData","rebuildTreeForData","visibleNodes","addExpandedChildren","expanded","expansionModel","selected","findNodeSiblings","arr","subResult","handleDragStart","dataTransfer","setData","setDragImage","emptyItem","nativeElement","dragNode","collapse","handleDragOver","preventDefault","dragNodeExpandOverNode","isExpanded","dragNodeExpandOverTime","expand","offsetX","clientWidth","percentageY","offsetY","clientHeight","dragNodeExpandOverArea","handleDrop","toFlatNode","fromFlatNode","parentLvl_1","dataNodes","expandDescendants","handleDragEnd","getParentNode","currentLevel","currentNode","nodeUpdated","dataToChange","siblings","newFolder","newNode","onButtonClicked","button","changedData","nodeClicked","getAllChildren","dataToEmit","allRows","apply","arguments","concat","__spread","createTranslateLoader","http","TranslateHttpLoader","providers","registerLocaleData","localeCa","localeEs","imports","RouterModule","HttpClientModule","CommonModule","FormsModule","NoopAnimationsModule","AngularHalModule","ReactiveFormsModule","BrowserAnimationsModule","AgGridModule","SitmunFrontendCoreModule","MaterialModule","TranslateModule","forRoot","loader","provide","TranslateLoader","useFactory","Éµ0","deps","HttpClient","declarations","entryComponents"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component, OnDestroy } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-btn-edit-rendered',\r\n  templateUrl: './btn-edit-rendered.component.html',\r\n  styleUrls: ['./btn-edit-rendered.component.scss']\r\n})\r\nexport class BtnEditRenderedComponent implements ICellRendererAngularComp, OnDestroy {\r\n\r\n  public params: any;\r\n\r\n  agInit(params: any): void {\r\n    this.params = params;\r\n  }\r\n\r\n  refresh(params: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  btnClickedHandler($event) {\r\n    this.params.clicked(this.params.value);\r\n  }\r\n\r\n  getParams(){\r\n    return this.params;\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    // no need to remove the button click handler \r\n  }\r\n\r\n}\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component, OnDestroy } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-btn-checkbox-rendered',\r\n  templateUrl: './btn-checkbox-rendered.component.html',\r\n  styleUrls: ['./btn-checkbox-rendered.component.scss']\r\n})\r\nexport class BtnCheckboxRenderedComponent implements ICellRendererAngularComp, OnDestroy {\r\n\r\n  public params: any;\r\n\r\n  agInit(params: any): void {\r\n    this.params = params;\r\n  }\r\n\r\n  refresh(params: any): boolean {\r\n    this.params = params;\r\n    \r\n    return true;\r\n  }\r\n\r\n  public invokeParentMethod() {\r\n    this.params.context.componentParent.methodFromParent(\r\n      `Row: ${this.params.node.rowIndex}, Col: ${this.params.colDef.headerName}`\r\n    );\r\n  }\r\n\r\n  btnCheckedHandler(event) {\r\n    let checked = !event.target.firstElementChild.checked;\r\n    let colId = this.params.column.colId;\r\n    this.params.value=checked;\r\n    this.params.api.undoRedoService.isFilling=true;\r\n    this.params.node.setDataValue(colId, checked);\r\n\r\n    \r\n  }\r\n\r\n  getParams(){\r\n    return this.params;\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    // no need to remove the button click handler \r\n  }\r\n\r\n}\r\n","import { Component, ViewChild, ViewContainerRef } from '@angular/core';\r\nimport {FormControl, Validators} from '@angular/forms';\r\nimport {\r\n  IAfterGuiAttachedParams,\r\n  IDoesFilterPassParams,\r\n  IFilterParams,\r\n  RowNode,\r\n  IFloatingFilter,\r\n  NumberFilter,\r\n  NumberFilterModel,\r\n  IFloatingFilterParams,\r\n} from '@ag-grid-community/all-modules';\r\nimport { AgFrameworkComponent } from '@ag-grid-community/angular';\r\nimport { IFilterAngularComp } from '@ag-grid-community/angular';\r\n\r\n@Component({\r\n  selector: 'app-btn-checkbox-filter',\r\n  templateUrl: './btn-checkbox-filter.component.html',\r\n  styleUrls: ['./btn-checkbox-filter.component.scss'],\r\n  host: {'class': 'hostClass'}\r\n})\r\nexport class BtnCheckboxFilterComponent implements IFloatingFilter, AgFrameworkComponent<IFloatingFilterParams>   {\r\n  private params: IFloatingFilterParams;\r\n  private valueGetter: (rowNode: RowNode) => any;\r\n  public text: string = '';\r\n  public currentValue: number;\r\n  @ViewChild('input', { read: ViewContainerRef }) public input;\r\n\r\n  agInit(params: IFloatingFilterParams): void {\r\n    this.params = params;\r\n    this.valueGetter = params.filterParams.valueGetter;\r\n    this.params.suppressFilterButton=true;\r\n  }\r\n\r\n  isFilterActive(): boolean {\r\n    return this.text != null && this.text !== '';\r\n  }\r\n\r\n  doesFilterPass(params: IDoesFilterPassParams): boolean {\r\n    return this.text\r\n      .toLowerCase()\r\n      .split(' ')\r\n      .every(\r\n        (filterWord) =>\r\n          this.valueGetter(params.node)\r\n            .toString()\r\n            .toLowerCase()\r\n            .indexOf(filterWord) >= 0\r\n      );\r\n  }\r\n\r\n  getModel(): any {\r\n    return { value: this.text };\r\n  }\r\n\r\n  setModel(model: any): void {\r\n    this.text = model ? model.value : '';\r\n  }\r\n\r\n\r\n onChange(newValue): void {\r\n    this.params.parentFilterInstance(function (instance) {\r\n      (<NumberFilter>instance).onFloatingFilterChanged(\r\n        'contains',\r\n        newValue\r\n      );\r\n    });\r\n  }\r\n\r\n  onParentModelChanged(parentModel: any): void {\r\n    if (!parentModel) {\r\n      this.currentValue = 0;\r\n    } else {\r\n      // note that the filter could be anything here, but our purposes we're assuming a greater than filter only,\r\n      // so just read off the value and use that\r\n      this.currentValue = parentModel.filter;\r\n    }\r\n  }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\n\r\n@Component({\r\n  selector: 'app-dialog-message',\r\n  templateUrl: './dialog-message.component.html',\r\n  styleUrls: ['./dialog-message.component.scss']\r\n})\r\nexport class DialogMessageComponent implements OnInit {\r\n\r\n  title: string;\r\n  message: string;\r\n  hideCancelButton : boolean=false;\r\n\r\n  constructor(private dialogRef: MatDialogRef<DialogMessageComponent>){ }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  doAccept(){\r\n    this.dialogRef.close({event:'Accept'});\r\n  }\r\n\r\n  closeDialog(){\r\n    this.dialogRef.close({event:'Cancel'});\r\n  }\r\n\r\n}\r\n","import { AgGridModule } from '@ag-grid-community/angular';\r\nimport { Component, OnInit, NgModule, Input, Output, EventEmitter } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { AllCommunityModules, ColumnApi, Module } from '@ag-grid-community/all-modules';\r\n\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { BtnEditRenderedComponent } from '../btn-edit-rendered/btn-edit-rendered.component';\r\nimport { BtnCheckboxRenderedComponent } from '../btn-checkbox-rendered/btn-checkbox-rendered.component';\r\nimport { BtnCheckboxFilterComponent } from '../btn-checkbox-filter/btn-checkbox-filter.component';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { DialogMessageComponent } from '../dialog-message/dialog-message.component';\r\n\r\n\r\n\r\n\r\n@Component({\r\n  selector: 'app-data-grid',\r\n  templateUrl: './data-grid.component.html',\r\n  styleUrls: ['./data-grid.component.scss']\r\n})\r\nexport class DataGridComponent implements OnInit {\r\n\r\n  private _eventRefreshSubscription: any;\r\n  private _eventGetSelectedRowsSubscription: any;\r\n  private _eventGetAllRowsSubscription: any;\r\n  private _eventSaveAgGridStateSubscription: any;\r\n  modules: Module[] = AllCommunityModules;\r\n\r\n\r\n  UndeRedoActions\r\n  searchValue: string;\r\n  private gridApi;\r\n  private gridColumnApi;\r\n  statusColumn = false;\r\n  changesMap: Map<number, Map<string, number>> = new Map<number, Map<string, number>>();\r\n  // We will save the id of edited cells and the number of editions done.\r\n  private params; // Last parameters of the grid (in case we do apply changes we will need it) \r\n  rowData: any[];\r\n  changeCounter: number; // Number of editions done above any cell \r\n  previousChangeCounter: number; // Number of ditions done after the last modification(changeCounter)\r\n  redoCounter: number; // Number of redo we can do\r\n  modificationChange = false;\r\n  undoNoChanges = false; // Boolean that indicates if an undo hasn't modifications\r\n  gridOptions;\r\n\r\n\r\n  @Input() eventRefreshSubscription: Observable<boolean>;\r\n  @Input() eventGetSelectedRowsSubscription: Observable<boolean>;\r\n  @Input() eventGetAllRowsSubscription: Observable<boolean>;\r\n  @Input() eventSaveAgGridStateSubscription: Observable<boolean>;\r\n  @Input() eventAddItemsSubscription: Observable<boolean>;\r\n  @Input() frameworkComponents: any;\r\n  @Input() columnDefs: any[];\r\n  @Input() getAll: () => Observable<any>;\r\n  @Input() discardChangesButton: boolean;\r\n  @Input() id: any;\r\n  @Input() undoButton: boolean;\r\n  @Input() defaultColumnSorting: string;\r\n  @Input() redoButton: boolean;\r\n  @Input() applyChangesButton: boolean;\r\n  @Input() deleteButton: boolean;\r\n  @Input() newButton: boolean;\r\n  @Input() actionButton: boolean;\r\n  @Input() addButton: boolean;\r\n  @Input() globalSearch: boolean;\r\n  @Input() themeGrid: any;\r\n  @Input() singleSelection: boolean;\r\n  @Input() nonEditable: boolean;\r\n  @Input() title: string;\r\n  @Input() hideExportButton: boolean;\r\n  @Input() hideDuplicateButton: boolean;\r\n  @Input() hideSearchReplaceButton: boolean;\r\n\r\n\r\n  @Output() remove: EventEmitter<any[]>;\r\n  @Output() new: EventEmitter<number>;\r\n  @Output() add: EventEmitter<number>;\r\n  @Output() sendChanges: EventEmitter<any[]>;\r\n  @Output() duplicate: EventEmitter<any[]>;\r\n  @Output() getSelectedRows: EventEmitter<any[]>;\r\n  @Output() getAllRows: EventEmitter<any[]>;\r\n  @Output() getAgGridState: EventEmitter<any[]>;\r\n\r\n\r\n  constructor(public dialog: MatDialog,\r\n    public translate: TranslateService,) {\r\n    this.translate = translate;\r\n\r\n    this.frameworkComponents = {\r\n      btnEditRendererComponent: BtnEditRenderedComponent,\r\n      btnCheckboxRendererComponent: BtnCheckboxRenderedComponent,\r\n      btnCheckboxFilterComponent: BtnCheckboxFilterComponent\r\n    };\r\n\r\n    this.remove = new EventEmitter();\r\n    this.new = new EventEmitter();\r\n    this.add = new EventEmitter();\r\n    this.sendChanges = new EventEmitter();\r\n    this.getSelectedRows = new EventEmitter();\r\n    this.duplicate = new EventEmitter();\r\n    this.getAllRows = new EventEmitter();\r\n    this.changeCounter = 0;\r\n    this.previousChangeCounter = 0;\r\n    this.redoCounter = 0;\r\n    this.gridOptions = {\r\n      defaultColDef: {\r\n        sortable: true,\r\n        flex: 1,\r\n        filter: true,\r\n        editable: !this.nonEditable,\r\n        cellStyle: { backgroundColor: '#FFFFFF' },\r\n        suppressMenu: true,\r\n        resizable: true\r\n      },\r\n      columnTypes: {\r\n        dateColumn: {\r\n          filter: 'agDateColumnFilter',\r\n          filterParams: {\r\n            comparator(filterLocalDateAtMidnight, cellValue) {\r\n              const dateCellValue = new Date(cellValue);\r\n              const dateFilter = new Date(filterLocalDateAtMidnight);\r\n\r\n              if (dateCellValue.getTime() < dateFilter.getTime()) {\r\n                return -1;\r\n              } else if (dateCellValue.getTime() > dateFilter.getTime()) {\r\n                return 1;\r\n              } else {\r\n                return 0;\r\n              }\r\n            },\r\n          },\r\n          suppressMenu: true\r\n        }\r\n      },\r\n      rowSelection: 'multiple',\r\n      singleClickEdit: true,\r\n      // suppressHorizontalScroll: true,\r\n      localeTextFunc: (key: string, defaultValue: string) => {\r\n        const data = this.translate.instant(key);\r\n        return data === key ? defaultValue : data;\r\n      }\r\n    }\r\n\r\n\r\n  }\r\n\r\n\r\n  ngOnInit() {\r\n\r\n    if (this.eventRefreshSubscription) {\r\n      this._eventRefreshSubscription = this.eventRefreshSubscription.subscribe(() => {\r\n        this.changesMap.clear();\r\n        this.changeCounter = 0;\r\n        this.previousChangeCounter = 0;\r\n        this.redoCounter = 0;\r\n        this.getElements();\r\n      });\r\n    }\r\n    if (this.eventGetSelectedRowsSubscription) {\r\n      this._eventGetSelectedRowsSubscription = this.eventGetSelectedRowsSubscription.subscribe(() => {\r\n        this.emitSelectedRows();\r\n      });\r\n    }\r\n    if (this.eventGetAllRowsSubscription) {\r\n      this._eventGetAllRowsSubscription = this.eventGetAllRowsSubscription.subscribe(() => {\r\n        this.emitAllRows();\r\n      });\r\n    }\r\n\r\n    if (this.eventSaveAgGridStateSubscription) {\r\n      this._eventSaveAgGridStateSubscription = this.eventSaveAgGridStateSubscription.subscribe(() => {\r\n        this.saveAgGridState();\r\n      });\r\n    }\r\n\r\n    if (this.eventAddItemsSubscription) {\r\n      this.eventAddItemsSubscription.subscribe(\r\n        (items: any) => {\r\n          this.addItems(items);\r\n        }\r\n      )\r\n    }\r\n  }\r\n\r\n\r\n  firstDataRendered(): void {\r\n    if (localStorage.agGridState != undefined) {\r\n      let agGridState = JSON.parse(localStorage.agGridState)\r\n      if (agGridState.idAgGrid != undefined && agGridState.idAgGrid == this.id) {\r\n        this.gridApi.setFilterModel(agGridState.filterState);\r\n        this.gridColumnApi.setColumnState(agGridState.colState);\r\n        this.gridApi.setSortModel(agGridState.sortState);\r\n        this.searchValue = agGridState.valueSearchGeneric;\r\n        this.quickSearch();\r\n        this.removeAgGridState();\r\n      } else if (this.id != undefined) {\r\n        this.removeAgGridState();\r\n      }\r\n    }\r\n  }\r\n\r\n  onGridReady(params): void {\r\n    if (this.singleSelection) { this.gridOptions.rowSelection = 'single' }\r\n    // if (this.nonEditable) {this.gridOptions.defaultColDef.editable = false}\r\n    this.params = params;\r\n    this.gridApi = params.api;\r\n    this.gridColumnApi = params.columnApi;\r\n    this.getElements();\r\n    console.log(this.columnDefs);\r\n    for (const col of this.columnDefs) {\r\n      if (col.field === 'status') {\r\n        console.log(\"status column true\");\r\n\r\n        this.statusColumn = true;\r\n      }\r\n    }\r\n    if(this.defaultColumnSorting){\r\n      const sortModel = [\r\n        {colId: this.defaultColumnSorting, sort: 'asc'}\r\n    ];\r\n    this.gridApi.setSortModel(sortModel);\r\n    }\r\n  }\r\n\r\n\r\n  emitSelectedRows(): void {\r\n    const selectedNodes = this.gridApi.getSelectedNodes();\r\n    const selectedData = selectedNodes.map(node => node.data);\r\n    this.getSelectedRows.emit(selectedData);\r\n  }\r\n\r\n  emitAllRows(): void {\r\n    let rowData = [];\r\n    this.gridApi.forEachNode(node => rowData.push(node.data));\r\n    this.getAllRows.emit(rowData);\r\n  }\r\n\r\n  saveAgGridState(): void {\r\n    let agGridState = {\r\n      idAgGrid: this.id,\r\n      colState: this.gridColumnApi.getColumnState(),\r\n      filterState: this.gridApi.getFilterModel(),\r\n      sortState: this.gridApi.getSortModel(),\r\n      valueSearchGeneric: this.searchValue\r\n    };\r\n\r\n    localStorage.setItem(\"agGridState\", JSON.stringify(agGridState));\r\n\r\n  }\r\n  removeAgGridState(): void {\r\n    localStorage.removeItem(\"agGridState\")\r\n  }\r\n\r\n  getColumnKeysAndHeaders(columnkeys: Array<any>): String {\r\n    let header: Array<any> = [];\r\n    if (this.columnDefs.length == 0) { return '' };\r\n\r\n    let allColumnKeys = this.gridOptions.columnApi.getAllDisplayedColumns();\r\n    // console.log(allColumnKeys);\r\n    allColumnKeys.forEach(element => {\r\n      if (element.userProvidedColDef.headerName !== '') {\r\n        columnkeys.push(element.userProvidedColDef.field);\r\n        header.push(element.userProvidedColDef.headerName);\r\n      }\r\n\r\n\r\n    });\r\n\r\n    return header.join(\",\");\r\n  }\r\n\r\n\r\n  exportData(): void {\r\n    let columnkeys: Array<any> = [];\r\n    let customHeader: String = '';\r\n    customHeader = this.getColumnKeysAndHeaders(columnkeys)\r\n    let params = {\r\n      onlySelected: true,\r\n      columnKeys: columnkeys,\r\n      customHeader: customHeader,\r\n      skipHeader: true\r\n    };\r\n    this.gridApi.exportDataAsCsv(params);\r\n  }\r\n\r\n  quickSearch(): void {\r\n    this.gridApi.setQuickFilter(this.searchValue);\r\n  }\r\n\r\n  getElements(): void {\r\n    this.getAll()\r\n      .subscribe((items) => {\r\n        this.rowData = items;\r\n        this.gridApi.setRowData(this.rowData);\r\n        this.gridApi.sizeColumnsToFit()\r\n        console.log(this.rowData);\r\n\r\n      });\r\n  }\r\n\r\n  addItems(newItems: any[]): void {\r\n    console.log(newItems);\r\n    let itemsToAdd: Array<any> = [];\r\n\r\n    newItems.forEach(item => {\r\n\r\n      if (item.id == undefined || (this.rowData.find(element => element.id === item.id)) == undefined) {\r\n        if (this.statusColumn) {\r\n          item.status = 'Pending creation'\r\n        }\r\n        itemsToAdd.push(item);\r\n        this.rowData.push(item);\r\n      }\r\n      else {\r\n        console.log(`Item with the ID ${item.id} already exists`)\r\n      }\r\n    });\r\n    this.gridApi.updateRowData({ add: itemsToAdd });\r\n\r\n    console.log(this.columnDefs);\r\n    // params.oldValue!=undefined\r\n  }\r\n\r\n\r\n\r\n\r\n  removeData(): void {\r\n    this.gridApi.stopEditing(false);\r\n    const selectedNodes = this.gridApi.getSelectedNodes();\r\n    const selectedData = selectedNodes.map(node => node.data);\r\n    this.remove.emit(selectedData);\r\n\r\n    if (this.statusColumn) {\r\n      const selectedRows = selectedNodes.map(node => node.id);\r\n\r\n      for (const id of selectedRows) {\r\n        this.gridApi.getRowNode(id).data.status = 'Deleted';\r\n      }\r\n      this.gridOptions.api.refreshCells();\r\n    }\r\n    this.gridOptions.api.deselectAll();\r\n  }\r\n\r\n  newData(): void {\r\n    this.gridApi.stopEditing(false);\r\n    this.new.emit(-1);\r\n  }\r\n\r\n  onAddButtonClicked(): void {\r\n    this.gridApi.stopEditing(false);\r\n    this.add.emit(-1);\r\n  }\r\n\r\n  onDuplicateButtonClicked(): void {\r\n    this.gridApi.stopEditing(false);\r\n    console.log(this.changeCounter);\r\n    if (this.changeCounter > 0) {\r\n      const dialogRef = this.dialog.open(DialogMessageComponent);\r\n      dialogRef.componentInstance.title = this.translate.instant('caution')\r\n      dialogRef.componentInstance.message = this.translate.instant('duplicateMessage')\r\n      dialogRef.afterClosed().subscribe(result => {\r\n        if (result) {\r\n          if (result.event === 'Accept') {\r\n            const selectedNodes = this.gridApi.getSelectedNodes();\r\n            const selectedData = selectedNodes.map(node => node.data);\r\n            this.duplicate.emit(selectedData);\r\n          }\r\n        }\r\n      });\r\n\r\n    }\r\n    else {\r\n      const selectedNodes = this.gridApi.getSelectedNodes();\r\n      const selectedData = selectedNodes.map(node => node.data);\r\n      this.duplicate.emit(selectedData);\r\n    }\r\n  }\r\n\r\n\r\n  applyChanges(): void {\r\n    const itemsChanged: any[] = [];\r\n    this.gridApi.stopEditing(false);\r\n    for (const key of this.changesMap.keys()) {\r\n      itemsChanged.push(this.gridApi.getRowNode(key).data);\r\n    }\r\n    this.sendChanges.emit(itemsChanged);\r\n    this.changesMap.clear();\r\n    this.changeCounter = 0;\r\n    this.previousChangeCounter = 0;\r\n    this.redoCounter = 0;\r\n    this.params.colDef.cellStyle = { backgroundColor: '#FFFFFF' };\r\n    this.gridApi.redrawRows();\r\n  }\r\n\r\n\r\n\r\n  deleteChanges(): void {\r\n    this.gridApi.stopEditing(false);\r\n\r\n    while (this.changeCounter > 0) {\r\n      this.undo();\r\n    }\r\n\r\n    this.changesMap.clear();\r\n    //this.previousChangeCounter = 0;\r\n    this.redoCounter = 0;\r\n\r\n\r\n    //this.params.colDef.cellStyle =  {backgroundColor: '#FFFFFF'};\r\n    //this.gridApi.redrawRows();\r\n  }\r\n\r\n\r\n  onFilterModified(): void {\r\n    this.deleteChanges();\r\n  }\r\n\r\n\r\n  undo(): void {\r\n    this.gridApi.stopEditing(false);\r\n    this.gridApi.undoCellEditing();\r\n    this.changeCounter -= 1;\r\n    this.redoCounter += 1;\r\n  }\r\n\r\n  redo(): void {\r\n    this.gridApi.stopEditing(false);\r\n    this.gridApi.redoCellEditing();\r\n    this.changeCounter += 1;\r\n    this.redoCounter -= 1;\r\n  }\r\n\r\n\r\n  onCellEditingStopped(e) {\r\n    if (this.modificationChange) {\r\n      this.changeCounter++;\r\n      this.redoCounter = 0;\r\n      this.onCellValueChanged(e);\r\n      this.modificationChange = false;\r\n    }\r\n  }\r\n\r\n\r\n  onCellValueChanged(params): void {\r\n    console.log(\"value Change\")\r\n    this.params = params;\r\n    if (this.changeCounter > this.previousChangeCounter)\r\n    // True if we have edited some cell or we have done a redo \r\n    {\r\n\r\n      if (params.oldValue !== params.value && !(params.oldValue == null && params.value === '')) {\r\n\r\n        if (!this.changesMap.has(params.node.id)) // If it's firts edit of a cell, we add it to the map and we paint it\r\n        {\r\n          const addMap: Map<string, number> = new Map<string, number>();\r\n          addMap.set(params.colDef.field, 1)\r\n          this.changesMap.set(params.node.id, addMap);\r\n          if (this.statusColumn) {\r\n            if (this.gridApi.getRowNode(params.node.id).data.status !== 'Pending creation') {\r\n              this.gridApi.getRowNode(params.node.id).data.status = 'Modified'\r\n            }\r\n          }\r\n        }\r\n        else {\r\n          if (!this.changesMap.get(params.node.id).has(params.colDef.field)) {\r\n\r\n            this.changesMap.get(params.node.id).set(params.colDef.field, 1);\r\n          }\r\n\r\n          else {\r\n            // We already had edited this cell, so we only increment number of changes of it on the map \r\n            const currentChanges = this.changesMap.get(params.node.id).get(params.colDef.field);\r\n            this.changesMap.get(params.node.id).set(params.colDef.field, (currentChanges + 1));\r\n          }\r\n\r\n        }\r\n        this.paintCells(params, this.changesMap); //We paint the row of the edited cell \r\n        this.previousChangeCounter++; //We match the current previousChangeCounter with changeCounter\r\n      }\r\n\r\n    }\r\n    else if (this.changeCounter < this.previousChangeCounter) { // True if we have done an undo\r\n      let currentChanges = -1;\r\n      if (this.changesMap.has(params.node.id)) { currentChanges = this.changesMap.get(params.node.id).get(params.colDef.field); }\r\n\r\n      if (currentChanges === 1) { //Once the undo it's done, cell is in his initial status\r\n\r\n        this.changesMap.get(params.node.id).delete(params.colDef.field);\r\n        if (this.changesMap.get(params.node.id).size === 0) { // No more modifications in this row\r\n          this.changesMap.delete(params.node.id);\r\n          const row = this.gridApi.getDisplayedRowAtIndex(params.rowIndex);\r\n          if (this.statusColumn) {\r\n            if (this.gridApi.getRowNode(params.node.id).data.status !== 'Pending creation') {\r\n              this.gridApi.getRowNode(params.node.id).data.status = ''\r\n            }\r\n          };\r\n          // We paint it white\r\n          this.gridApi.redrawRows({ rowNodes: [row] });\r\n\r\n        }\r\n        else {\r\n          this.paintCells(params, this.changesMap);\r\n        }\r\n\r\n      }\r\n      else if (currentChanges > 1) // The cell isn't in his initial state yet\r\n      {                                 //We can't do else because we can be doing an undo without changes \r\n        this.changesMap.get(params.node.id).set(params.colDef.field, (currentChanges - 1));\r\n\r\n        this.paintCells(params, this.changesMap);//Not initial state -> green background\r\n\r\n      }\r\n      this.previousChangeCounter--;  //We decrement previousChangeCounter because we have done undo\r\n    }\r\n    else { // Control of modifications without changes\r\n      if (!(params.oldValue == null && params.value === '')) {\r\n        let newValue: string;\r\n        if (params.value == null) { newValue = '' }\r\n        else { newValue = params.value.toString() }\r\n\r\n        if ((params.oldValue != undefined && params.oldValue != null && params.oldValue.toString() !== newValue.toString())\r\n          || ((params.oldValue == undefined || params.oldValue == null) && newValue != null)) {\r\n\r\n          this.modificationChange = true;\r\n          if (params.colDef.cellRenderer == \"btnCheckboxRendererComponent\") {\r\n            var undoRedoActions = {\r\n              cellValueChanges: this.gridApi.undoRedoService.cellValueChanges\r\n            };\r\n            this.gridApi.undoRedoService.pushActionsToUndoStack(undoRedoActions);\r\n            this.gridApi.undoRedoService.isFilling = false;\r\n            this.onCellEditingStopped(params);\r\n          }\r\n        }\r\n        else { this.modificationWithoutChanges(params) }\r\n\r\n      }\r\n      else { this.modificationWithoutChanges(params) }\r\n    }\r\n  }\r\n\r\n  modificationWithoutChanges(params: any) {\r\n\r\n    if (this.changesMap.has(params.node.id)) //Modification without changes in en edited cell\r\n    {\r\n      if (!this.undoNoChanges) {\r\n        this.gridApi.undoCellEditing(); // Undo to delete the change without changes internally \r\n        this.undoNoChanges = true;\r\n        this.paintCells(params, this.changesMap);  //The cell has modifications yet -> green background \r\n      }\r\n      else { this.undoNoChanges = false; }\r\n\r\n\r\n    }\r\n    else {\r\n      //With the internally undo will enter at this function, so we have to control when done the undo or not \r\n      if (!this.undoNoChanges) {\r\n        this.gridApi.undoCellEditing(); // Undo to delete the change internally\r\n        this.undoNoChanges = true;\r\n      }\r\n      else { this.undoNoChanges = false; }\r\n    }\r\n\r\n  }\r\n\r\n  getColumnIndexByColId(api: ColumnApi, colId: string): number {\r\n    return api.getAllColumns().findIndex(col => col.getColId() === colId);\r\n  }\r\n  paintCells(params: any, changesMap: Map<number, Map<string, number>>,) {\r\n    const row = this.gridApi.getDisplayedRowAtIndex(params.rowIndex);\r\n\r\n    this.changeCellStyleColumns(params, changesMap, '#E8F1DE');\r\n    this.gridApi.redrawRows({ rowNodes: [row] });\r\n    this.changeCellStyleColumns(params, changesMap, '#FFFFFF');\r\n    // We will define cellStyle white to future modifications (like filter)\r\n  }\r\n\r\n  changeCellStyleColumns(params: any, changesMap: Map<number, Map<string, number>>, color: string) {\r\n\r\n    for (const key of changesMap.get(params.node.id).keys()) {\r\n      const columnNumber = this.getColumnIndexByColId(this.gridColumnApi, key);\r\n      this.gridColumnApi.columnController.gridColumns[columnNumber].colDef.cellStyle = { backgroundColor: color };\r\n    }\r\n\r\n\r\n  }\r\n\r\n}\r\n","import {NgModule} from '@angular/core';\r\nimport {A11yModule} from '@angular/cdk/a11y';\r\nimport {DragDropModule} from '@angular/cdk/drag-drop';\r\nimport {PortalModule} from '@angular/cdk/portal';\r\nimport {ScrollingModule} from '@angular/cdk/scrolling';\r\nimport {CdkStepperModule} from '@angular/cdk/stepper';\r\nimport {CdkTableModule} from '@angular/cdk/table';\r\nimport {CdkTreeModule} from '@angular/cdk/tree';\r\nimport {MatAutocompleteModule} from '@angular/material/autocomplete';\r\nimport {MatBadgeModule} from '@angular/material/badge';\r\nimport {MatBottomSheetModule} from '@angular/material/bottom-sheet';\r\nimport {MatButtonModule} from '@angular/material/button';\r\nimport {MatButtonToggleModule} from '@angular/material/button-toggle';\r\nimport {MatCardModule} from '@angular/material/card';\r\nimport {MatCheckboxModule} from '@angular/material/checkbox';\r\nimport {MatChipsModule} from '@angular/material/chips';\r\nimport {MatStepperModule} from '@angular/material/stepper';\r\nimport {MatDatepickerModule} from '@angular/material/datepicker';\r\nimport {MatDialogModule} from '@angular/material/dialog';\r\nimport {MatDividerModule} from '@angular/material/divider';\r\nimport {MatExpansionModule} from '@angular/material/expansion';\r\nimport {MatGridListModule} from '@angular/material/grid-list';\r\nimport {MatIconModule} from '@angular/material/icon';\r\nimport {MatInputModule} from '@angular/material/input';\r\nimport {MatListModule} from '@angular/material/list';\r\nimport {MatMenuModule} from '@angular/material/menu';\r\nimport {MatNativeDateModule, MatRippleModule} from '@angular/material/core';\r\nimport {MatPaginatorModule} from '@angular/material/paginator';\r\nimport {MatProgressBarModule} from '@angular/material/progress-bar';\r\nimport {MatProgressSpinnerModule} from '@angular/material/progress-spinner';\r\nimport {MatRadioModule} from '@angular/material/radio';\r\nimport {MatSelectModule} from '@angular/material/select';\r\nimport {MatSidenavModule} from '@angular/material/sidenav';\r\nimport {MatSliderModule} from '@angular/material/slider';\r\nimport {MatSlideToggleModule} from '@angular/material/slide-toggle';\r\nimport {MatSnackBarModule} from '@angular/material/snack-bar';\r\nimport {MatSortModule} from '@angular/material/sort';\r\nimport {MatTableModule} from '@angular/material/table';\r\nimport {MatTabsModule} from '@angular/material/tabs';\r\nimport {MatToolbarModule} from '@angular/material/toolbar';\r\nimport {MatTooltipModule} from '@angular/material/tooltip';\r\nimport {MatTreeModule} from '@angular/material/tree';\r\nimport {MatFormFieldModule} from '@angular/material/form-field';\r\n\r\n@NgModule({\r\n  exports: [\r\n    A11yModule,\r\n    CdkStepperModule,\r\n    CdkTableModule,\r\n    CdkTreeModule,\r\n    DragDropModule,\r\n    MatAutocompleteModule,\r\n    MatBadgeModule,\r\n    MatBottomSheetModule,\r\n    MatButtonModule,\r\n    MatButtonToggleModule,\r\n    MatCardModule,\r\n    MatCheckboxModule,\r\n    MatChipsModule,\r\n    MatStepperModule,\r\n    MatDatepickerModule,\r\n    MatDialogModule,\r\n    MatDividerModule,\r\n    MatExpansionModule,\r\n    MatGridListModule,\r\n    MatIconModule,\r\n    MatInputModule,\r\n    MatListModule,\r\n    MatMenuModule,\r\n    MatNativeDateModule,\r\n    MatPaginatorModule,\r\n    MatProgressBarModule,\r\n    MatProgressSpinnerModule,\r\n    MatRadioModule,\r\n    MatRippleModule,\r\n    MatSelectModule,\r\n    MatSidenavModule,\r\n    MatSliderModule,\r\n    MatSlideToggleModule,\r\n    MatSnackBarModule,\r\n    MatSortModule,\r\n    MatTableModule,\r\n    MatTabsModule,\r\n    MatToolbarModule,\r\n    MatTooltipModule,\r\n    MatTreeModule,\r\n    PortalModule,\r\n    ScrollingModule,\r\n    MatFormFieldModule\r\n  ]\r\n})\r\nexport class MaterialModule {}\r\n","import { Component, OnInit, Input, Output, EventEmitter, Inject } from '@angular/core';\r\nimport { Observable, Subject } from 'rxjs';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\n\r\nexport interface DialogData {\r\n  _GetAllsTable:  Array<() => Observable<any>>;\r\n  _columnDefsTable: Array<any[]>;\r\n  _singleSelectionTable: Array<boolean>;\r\n}\r\n\r\n\r\n@Component({\r\n  selector: 'app-dialog-grid',\r\n  templateUrl: './dialog-grid.component.html',\r\n  styleUrls: ['./dialog-grid.component.scss']\r\n})\r\nexport class DialogGridComponent implements OnInit {\r\n\r\n  title: string;\r\n  getAllRows: Subject<boolean> = new Subject <boolean>();\r\n  private _addButtonClickedSubscription: any;\r\n  tablesReceivedCounter: number;\r\n  allRowsReceived: Array<any[]> = [];\r\n\r\n  //Inputs\r\n  themeGrid: any;\r\n  getAllsTable: Array<() => Observable<any>>;\r\n  columnDefsTable: Array<any[]>;\r\n  singleSelectionTable: Array<boolean>;\r\n  titlesTable: Array<string>;\r\n  addButtonClickedSubscription: Observable <boolean> ;\r\n  nonEditable: boolean;\r\n\r\n  //Outputs\r\n  @Output() joinTables : EventEmitter<Array<any[]>>;\r\n\r\n  \r\n\r\n\r\n  constructor(private dialogRef: MatDialogRef<DialogGridComponent>) {\r\n    \r\n    this.joinTables = new EventEmitter();\r\n    // this.nonEditable = true;\r\n    this.tablesReceivedCounter = 0;\r\n   }\r\n\r\n  ngOnInit() {\r\n\r\n    if (this.addButtonClickedSubscription) {\r\n      this._addButtonClickedSubscription = this.addButtonClickedSubscription.subscribe(() => {\r\n        this.getAllSelectedRows();\r\n      });\r\n    }\r\n\r\n  }\r\n\r\n  getAllSelectedRows() {\r\n    this.getAllRows.next(true);\r\n  }\r\n\r\n  joinRowsReceived(data: any[])\r\n  {\r\n      this.allRowsReceived.push(data);\r\n      this.tablesReceivedCounter++;\r\n      if(this.tablesReceivedCounter === this.getAllsTable.length)\r\n      {\r\n        this.doAdd(this.allRowsReceived);\r\n        console.log(this.allRowsReceived);\r\n      }\r\n  }\r\n\r\n  doAdd(rowsToAdd){\r\n    this.dialogRef.close({event:'Add',data: rowsToAdd});\r\n  }\r\n\r\n  closeDialog(){\r\n    this.dialogRef.close({event:'Cancel'});\r\n  }\r\n\r\n}\r\n","import { Component, ElementRef, OnInit, TemplateRef, ViewChild } from '@angular/core';\r\nimport { FormGroup,FormControl,Validators } from '@angular/forms';\r\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog'; \r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { DialogMessageComponent } from '../dialog-message/dialog-message.component';\r\n\r\n@Component({\r\n  selector: 'app-dialog-form',\r\n  templateUrl: './dialog-form.component.html',\r\n  styleUrls: ['./dialog-form.component.scss']\r\n})\r\nexport class DialogFormComponent implements OnInit {\r\n\r\n  form: FormGroup;\r\n  title: string;\r\n  HTMLReceived;\r\n  constructor(\r\n    private dialogRef: MatDialogRef<DialogFormComponent>,\r\n    public dialog: MatDialog,\r\n    private translate: TranslateService) {}\r\n\r\n  ngOnInit(): void {\r\n\r\n  }\r\n\r\n\r\n  doAdd(){\r\n    if(this.form.valid) { this.dialogRef.close({event:'Add'}); }\r\n    else {\r\n       const dialogRef = this.dialog.open(DialogMessageComponent);\r\n       dialogRef.componentInstance.title = this.translate.instant(\"atention\")\r\n       dialogRef.componentInstance.message = this.translate.instant(\"requiredFieldMessage\")\r\n       dialogRef.componentInstance.hideCancelButton = true;\r\n       dialogRef.afterClosed().subscribe();\r\n    }\r\n\r\n  }\r\n\r\n  closeDialog(){\r\n    this.dialogRef.close({event:'Cancel'});\r\n  }\r\n\r\n}\r\n","import { FlatTreeControl } from '@angular/cdk/tree';\r\nimport { Component, EventEmitter, Injectable, Input, Output,ElementRef, ViewChild } from '@angular/core';\r\nimport { MatTreeFlatDataSource, MatTreeFlattener } from '@angular/material/tree';\r\nimport { BehaviorSubject, Observable, of as observableOf } from 'rxjs';\r\nimport { CdkDragDrop } from '@angular/cdk/drag-drop';\r\nimport { SelectionModel } from '@angular/cdk/collections';\r\nimport { forEach } from 'jszip';\r\n\r\n/**\r\n * File node data with nested structure.\r\n * Each node has a name, and a type or a list of children.\r\n */\r\nexport class FileNode {\r\n  id: string;\r\n  children: FileNode[];\r\n  name: string;\r\n  type: any;\r\n  active: any\r\n  cartographyId: any\r\n  cartographyName: any\r\n  datasetURL: any\r\n  description: any\r\n  filterGetFeatureInfo: any\r\n  filterGetMap: any\r\n  filterSelectable: any\r\n  isFolder: any\r\n  metadataURL: any\r\n  order: any\r\n  parent: any\r\n  queryableActive: any\r\n  radio: any\r\n  tooltip: any\r\n  _links: any\r\n}\r\n\r\n/** Flat node with expandable and level information */\r\nexport class FileFlatNode {\r\n  constructor(\r\n    public expandable: boolean,\r\n    public name: string,\r\n    public level: number,\r\n    public type: any,\r\n    public id: string\r\n  ) { }\r\n}\r\n\r\n\r\n\r\n/**\r\n * File database, it can build a tree structured Json object from string.\r\n * Each node in Json object represents a file or a directory. For a file, it has name and type.\r\n * For a directory, it has name and children (a list of files or directories).\r\n * The input will be a json object string, and the output is a list of `FileNode` with nested\r\n * structure.\r\n */\r\n@Injectable()\r\nexport class FileDatabase {\r\n  dataChange = new BehaviorSubject<FileNode[]>([]);\r\n  get data(): any { return this.dataChange.value; }\r\n\r\n  constructor() {\r\n\r\n  }\r\n\r\n  initialize(dataObj) {\r\n\r\n    // Build the tree nodes from Json object. The result is a list of `FileNode` with nested\r\n    //     file node as children.\r\n    const data = this.buildFileTree(dataObj, 0);\r\n\r\n    // Notify the change.\r\n    this.dataChange.next(data);\r\n  }\r\n\r\n  /**\r\n   * Build the file structure tree. The `value` is the Json object, or a sub-tree of a Json object.\r\n   * The return value is the list of `FileNode`.\r\n   */\r\n  buildFileTree(arrayTreeNodes: any[], level: number): any {\r\n    var map = {};\r\n    arrayTreeNodes.forEach((treeNode) => {\r\n      var obj = treeNode;\r\n      obj.children = [];\r\n      obj.type= (treeNode.isFolder)? \"folder\" : \"node\";\r\n\r\n      if(!map[obj.id]) {map[obj.id] = obj;}\r\n      else{\r\n        let previousChildren= map[obj.id].children\r\n        map[obj.id] = obj;\r\n        map[obj.id].children=previousChildren\r\n      }\r\n      var parent = obj.parent || 'root';\r\n      if (!map[parent]) {\r\n        map[parent] = {\r\n          children: []\r\n        };\r\n      }\r\n      map[parent].children.push(obj);\r\n    });\r\n    map['root'].type='folder';\r\n    map['root'].name='Root';\r\n    map['root'].isFolder=true;\r\n\r\n    return map['root'];\r\n  }\r\n  \r\n\r\n  deleteItem(node: FileNode) {\r\n    this.deleteNode(this.data.children, node);\r\n    this.dataChange.next(this.data);\r\n  }\r\n\r\n  deleteNode(nodes: FileNode[], nodeToDelete: FileNode) {\r\n    const index = nodes.indexOf(nodeToDelete, 0);\r\n    if (index > -1) {\r\n      nodes.splice(index, 1);\r\n    } else {\r\n      nodes.forEach(node => {\r\n        if (node.children && node.children.length > 0) {\r\n          this.deleteNode(node.children, nodeToDelete);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  copyPasteItem(from: FileNode, to: FileNode): FileNode {\r\n    const newItem = this.insertItem(to, from);\r\n\r\n    return newItem;\r\n  }\r\n\r\n  copyPasteItemAbove(from: FileNode, to: FileNode): FileNode {\r\n    const newItem = this.insertItemAbove(to, from);\r\n\r\n    return newItem;\r\n  }\r\n\r\n  copyPasteItemBelow(from: FileNode, to: FileNode): FileNode {\r\n    const newItem = this.insertItemBelow(to, from);\r\n\r\n    return newItem;\r\n  }\r\n\r\n  /** Add an item to to-do list */\r\n  \r\n  getNewItem(node:FileNode){\r\n    const newItem = {\r\n      name: node.name,\r\n      children: node.children,\r\n      type: node.type,\r\n      id: node.id, \r\n      active: node.active,\r\n      cartographyId: node.cartographyId,\r\n      cartographyName: node.cartographyName,\r\n      datasetURL: node.datasetURL,\r\n      description: node.description,\r\n      filterGetFeatureInfo: node.filterGetFeatureInfo,\r\n      filterGetMap: node.filterGetMap,\r\n      filterSelectable: node.filterSelectable,\r\n      isFolder: node.isFolder,\r\n      metadataURL: node.metadataURL,\r\n      order: node.order,\r\n      queryableActive: node.queryableActive,\r\n      radio: node.radio,\r\n      tooltip: node.tooltip,\r\n      _links: node._links } as FileNode;\r\n\r\n    return newItem;\r\n  }\r\n\r\n  insertItem(parent: FileNode, node: FileNode): FileNode {\r\n    if (!parent.children) {\r\n      parent.children = [];\r\n    }\r\n    const newItem = this.getNewItem(node)\r\n    newItem.parent = parent==null || parent.id==undefined?null:parent.id;\r\n\r\n    parent.children.push(newItem);\r\n    this.dataChange.next(this.data);\r\n    return newItem;\r\n  }\r\n\r\n  insertItemAbove(node: FileNode, nodeDrag: FileNode): FileNode {\r\n    const parentNode = this.getParentFromNodes(node);\r\n    const newItem = this.getNewItem(nodeDrag)\r\n    newItem.parent = parentNode==null || parentNode.id==undefined?null:parentNode.id;\r\n\r\n    if (parentNode != null) {\r\n      parentNode.children.splice(parentNode.children.indexOf(node), 0, newItem);\r\n    } else {\r\n      this.data.children.splice(this.data.children.indexOf(node), 0, newItem);\r\n    }\r\n    this.dataChange.next(this.data);\r\n    return newItem;\r\n  }\r\n\r\n  insertItemBelow(node: FileNode, nodeDrag: FileNode): FileNode {\r\n    const parentNode = this.getParentFromNodes(node);\r\n   \r\n    const newItem = this.getNewItem(nodeDrag)\r\n    newItem.parent = parentNode==null || parentNode.id==undefined?null:parentNode.id;\r\n\r\n    if (parentNode != null) {\r\n      parentNode.children.splice(parentNode.children.indexOf(node) + 1, 0, newItem);\r\n    } else {\r\n      this.data.children.splice(this.data.children.indexOf(node) + 1, 0, newItem);\r\n    }\r\n    this.dataChange.next(this.data);\r\n    return newItem;\r\n  }\r\n\r\n  \r\n  getParentFromNodes(node: FileNode): FileNode {\r\n    for (let i = 0; i < this.data.children.length; ++i) {\r\n      const currentRoot = this.data.children[i];\r\n      const parent = this.getParent(currentRoot, node);\r\n      if (parent != null) {\r\n        return parent;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  \r\n  getParent(currentRoot: FileNode, node: FileNode): FileNode {\r\n    if (currentRoot.children && currentRoot.children.length > 0) {\r\n      for (let i = 0; i < currentRoot.children.length; ++i) {\r\n        const child = currentRoot.children[i];\r\n        if (child === node) {\r\n          return currentRoot;\r\n        } else if (child.children && child.children.length > 0) {\r\n          const parent = this.getParent(child, node);\r\n          if (parent != null) {\r\n            return parent;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n}\r\n\r\n/**\r\n * @title Tree with flat nodes\r\n */\r\n@Component({\r\n  selector: 'app-data-tree',\r\n  templateUrl: 'data-tree.component.html',\r\n  styleUrls: ['data-tree.component.scss'],\r\n  providers: [FileDatabase]\r\n})\r\nexport class DataTreeComponent {\r\n  @Output() createNode: EventEmitter<any>;\r\n  @Output() createFolder: EventEmitter<any>;\r\n  @Output() emitNode: EventEmitter<any>;\r\n  @Output() emitAllNodes: EventEmitter<any>;\r\n  @Input() eventNodeUpdatedSubscription: Observable <any> ;\r\n  @Input() eventCreateNodeSubscription: Observable <any> ;\r\n  @Input() eventGetAllRowsSubscription: Observable <any> ;\r\n  private _eventNodeUpdatedSubscription: any;\r\n  private _eventCreateNodeSubscription: any;\r\n  private _eventGetAllRowsSubscription: any;\r\n  treeControl: FlatTreeControl<FileFlatNode>;\r\n  treeFlattener: MatTreeFlattener<FileNode, FileFlatNode>;\r\n  dataSource: MatTreeFlatDataSource<FileNode, FileFlatNode>;\r\n  // expansion model tracks expansion state\r\n  expansionModel = new SelectionModel<string>(true);\r\n  dragging = false;\r\n  expandTimeout: any;\r\n  expandDelay = 1000;\r\n  validateDrop = false;\r\n  treeData: any;\r\n\r\n  @Input() getAll: () => Observable<any>;\r\n\r\n\r\n  /* Drag and drop */\r\n  dragNode: any;\r\n  dragNodeExpandOverWaitTimeMs = 1500;\r\n  dragNodeExpandOverNode: any;\r\n  dragNodeExpandOverTime: number;\r\n  dragNodeExpandOverArea: string;\r\n  @ViewChild('emptyItem') emptyItem: ElementRef;\r\n\r\n    /** Map from flat node to nested node. This helps us finding the nested node to be modified */\r\n    flatNodeMap = new Map<FileFlatNode, FileNode>();\r\n\r\n    /** Map from nested node to flattened node. This helps us to keep the same object for selection */\r\n    nestedNodeMap = new Map<FileNode, FileFlatNode>();\r\n\r\n\r\n  constructor(public database: FileDatabase) {\r\n    this.emitNode = new EventEmitter();\r\n    this.createNode = new EventEmitter();\r\n    this.createFolder = new EventEmitter();\r\n    this.emitAllNodes = new EventEmitter();\r\n    this.treeFlattener = new MatTreeFlattener(this.transformer, this._getLevel,\r\n      this._isExpandable, this._getChildren);\r\n    this.treeControl = new FlatTreeControl<FileFlatNode>(this._getLevel, this._isExpandable);\r\n    this.dataSource = new MatTreeFlatDataSource(this.treeControl, this.treeFlattener);\r\n \r\n  }\r\n\r\n  ngOnInit(){\r\n\r\n    if(this.eventNodeUpdatedSubscription)\r\n    {\r\n      this.eventNodeUpdatedSubscription.subscribe(\r\n        (node) => {\r\n          this.updateNode(node);\r\n        }\r\n      )\r\n    }\r\n    if(this.eventCreateNodeSubscription)\r\n    {\r\n      this.eventCreateNodeSubscription.subscribe(\r\n        (node) => {\r\n          if(node.isFolder) this.createNewFolder(node);\r\n          else this.createNewNode(node);\r\n        }\r\n      )\r\n    }\r\n\r\n    if (this.eventGetAllRowsSubscription) {\r\n      this._eventGetAllRowsSubscription = this.eventGetAllRowsSubscription.subscribe(() => {\r\n        this.emitAllRows();\r\n      });\r\n    }\r\n    \r\n    this.getAll()\r\n    .subscribe((items) => {\r\n      this.treeData = items;\r\n      this.database.initialize(this.treeData);\r\n      this.database.dataChange.subscribe(data => this.rebuildTreeForData([data]));\r\n    });\r\n  }\r\n\r\n\r\n  transformer = (node: FileNode, level: number) => {\r\n    const existingNode = this.nestedNodeMap.get(node);\r\n    const flatNode = existingNode && existingNode.name === node.name\r\n      ? existingNode\r\n      : new FileFlatNode((node.children && node.children.length > 0),node.name,level,node.type,node.id);\r\n\r\n    this.flatNodeMap.set(flatNode, node);\r\n    this.nestedNodeMap.set(node, flatNode);\r\n    return flatNode;\r\n  \r\n  }\r\n  private _getLevel = (node: FileFlatNode) => node.level;\r\n  private _isExpandable = (node: FileFlatNode) => node.expandable;\r\n  private _getChildren = (node: FileNode): Observable<FileNode[]> => observableOf(node.children);\r\n  hasChild = (_: number, _nodeData: FileFlatNode) => _nodeData.expandable;\r\n\r\n\r\n  /**\r\n   * This constructs an array of nodes that matches the DOM\r\n   */\r\n  visibleNodes(): FileNode[] {\r\n    const result = [];\r\n\r\n    function addExpandedChildren(node: FileNode, expanded: string[]) {\r\n      result.push(node);\r\n      if (expanded.indexOf(node.id) != -1) {\r\n        node.children.map((child) => addExpandedChildren(child, expanded));\r\n      }\r\n    }\r\n    this.dataSource.data.forEach((node) => {\r\n      addExpandedChildren(node, this.expansionModel.selected);\r\n    });\r\n    return result;\r\n  }\r\n\r\n\r\n   findNodeSiblings(arr: Array<any>, id: string): Array<any> {\r\n    let result, subResult;\r\n    arr.forEach((item, i) => {\r\n      if (item.id === id) {\r\n        result = arr;\r\n      } else if (item.children) {\r\n        subResult = this.findNodeSiblings(item.children, id);\r\n        if (subResult) result = subResult;\r\n      }\r\n    });\r\n    return result;\r\n\r\n  }\r\n\r\n\r\n  handleDragStart(event, node) {\r\n    // Required by Firefox (https://stackoverflow.com/questions/19055264/why-doesnt-html5-drag-and-drop-work-in-firefox)\r\n    event.dataTransfer.setData('foo', 'bar');\r\n    event.dataTransfer.setDragImage(this.emptyItem.nativeElement, 0, 0);\r\n    this.dragNode = node;\r\n    this.treeControl.collapse(node);\r\n  }\r\n\r\n  handleDragOver(event, node) {\r\n    event.preventDefault();\r\n\r\n    // Handle node expand\r\n    if (node === this.dragNodeExpandOverNode) {\r\n      if (this.dragNode !== node && !this.treeControl.isExpanded(node)) {\r\n        if ((new Date().getTime() - this.dragNodeExpandOverTime) > this.dragNodeExpandOverWaitTimeMs) {\r\n          this.treeControl.expand(node);\r\n        }\r\n      }\r\n    } else {\r\n      this.dragNodeExpandOverNode = node;\r\n      this.dragNodeExpandOverTime = new Date().getTime();\r\n    }\r\n\r\n    // Handle drag area\r\n    const percentageX = event.offsetX / event.target.clientWidth;\r\n    const percentageY = event.offsetY / event.target.clientHeight;\r\n    if (percentageY < 0.25) {\r\n      this.dragNodeExpandOverArea = 'above';\r\n    } else if (percentageY > 0.75) {\r\n      this.dragNodeExpandOverArea = 'below';\r\n    } else {\r\n      this.dragNodeExpandOverArea = 'center';\r\n    }\r\n  }\r\n\r\n  handleDrop(event, node) {\r\n    event.preventDefault();\r\n    let toFlatNode=this.flatNodeMap.get(node);\r\n    let fromFlatNode=this.flatNodeMap.get(this.dragNode)\r\n    if (node !== this.dragNode && (this.dragNodeExpandOverArea !== 'center' || (this.dragNodeExpandOverArea === 'center' && toFlatNode.isFolder))) {\r\n      let newItem: FileNode;\r\n\r\n      if (this.dragNodeExpandOverArea === 'above') {\r\n        newItem = this.database.copyPasteItemAbove(fromFlatNode,toFlatNode);\r\n      } else if (this.dragNodeExpandOverArea === 'below') {\r\n        newItem = this.database.copyPasteItemBelow(fromFlatNode,toFlatNode);\r\n      } else {\r\n        newItem = this.database.copyPasteItem(fromFlatNode, toFlatNode);\r\n      }\r\n      let parentLvl=this.treeControl.dataNodes.find((n) => n.id === fromFlatNode.id).level;\r\n      fromFlatNode.children.forEach(child=>{\r\n        this.treeControl.dataNodes.find((n) => n.id === child.id).level=parentLvl+1\r\n      });\r\n      this.database.deleteItem(this.flatNodeMap.get(this.dragNode));\r\n      this.treeControl.expandDescendants(this.nestedNodeMap.get(newItem));\r\n    }\r\n   \r\n    this.dragNode = null;\r\n    this.dragNodeExpandOverNode = null;\r\n    this.dragNodeExpandOverTime = 0;\r\n  }\r\n\r\n  handleDragEnd(event) {\r\n    this.dragNode = null;\r\n    this.dragNodeExpandOverNode = null;\r\n    this.dragNodeExpandOverTime = 0;\r\n  }\r\n\r\n  /**\r\n   * The following methods are for persisting the tree expand state\r\n   * after being rebuilt\r\n   */\r\n\r\n  rebuildTreeForData(data: any[]) {\r\n    /*this.dataSource.data = data;\r\n    this.expansionModel.selected.forEach((id) => {\r\n      const node = this.treeControl.dataNodes.find((n) => n.id === id);\r\n      this.treeControl.expand(node);\r\n    });*/\r\n    this.dataSource.data = [];\r\n    this.dataSource.data = data;\r\n  }\r\n\r\n  private getParentNode(node: FileFlatNode): FileFlatNode | null {\r\n    const currentLevel = node.level;\r\n    if (currentLevel < 1) {\r\n      return null;\r\n    }\r\n    const startIndex = this.treeControl.dataNodes.indexOf(node) - 1;\r\n    for (let i = startIndex; i >= 0; i--) {\r\n      const currentNode = this.treeControl.dataNodes[i];\r\n      if (currentNode.level < currentLevel) {\r\n        return currentNode;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  updateNode(nodeUpdated)\r\n  {\r\n    const dataToChange = JSON.parse(JSON.stringify(this.dataSource.data))\r\n    const siblings = this.findNodeSiblings(dataToChange, nodeUpdated.id);\r\n    let index= siblings.findIndex(node => node.id === nodeUpdated.id)\r\n    siblings[index]=nodeUpdated;\r\n    this.rebuildTreeForData(dataToChange);\r\n\r\n  }\r\n\r\n  createNewFolder(newFolder)\r\n  {\r\n    newFolder.type=\"folder\";\r\n    const dataToChange = JSON.parse(JSON.stringify(this.dataSource.data))\r\n    if(newFolder.parent === null) {dataToChange.push(newFolder)}\r\n    else{\r\n      const siblings = this.findNodeSiblings(dataToChange, newFolder.parent);\r\n      let index= siblings.findIndex(node => node.id === newFolder.parent);\r\n      siblings[index].children.push(newFolder)\r\n    }\r\n    this.rebuildTreeForData(dataToChange);\r\n\r\n  }\r\n\r\n  createNewNode(newNode)\r\n  {\r\n    newNode.type=\"node\";\r\n    const dataToChange = JSON.parse(JSON.stringify(this.dataSource.data))\r\n    const siblings = this.findNodeSiblings(dataToChange, newNode.parent);\r\n    let index= siblings.findIndex(node => node.id === newNode.parent);\r\n    siblings[index].children.push(newNode)\r\n    \r\n\r\n    this.rebuildTreeForData(dataToChange);\r\n\r\n  }\r\n\r\n\r\n\r\n  onButtonClicked(id, button: string)\r\n  {\r\n    const changedData = JSON.parse(JSON.stringify(this.dataSource.data))\r\n    const siblings = this.findNodeSiblings(changedData, id);\r\n    let nodeClicked= siblings.find(node => node.id === id);\r\n    if(button ==='edit')  {this.emitNode.emit(nodeClicked)}\r\n    else if(button === 'newFolder') {this.createFolder.emit(nodeClicked)}\r\n    else if(button === 'newNode') {this.createNode.emit( nodeClicked)}\r\n    else if(button === 'delete') {\r\n      let children= this.getAllChildren(nodeClicked.children)\r\n      children.forEach(children => {\r\n        children.status='Deleted';\r\n      });\r\n      nodeClicked.children=children\r\n      nodeClicked.status='Deleted'\r\n      this.rebuildTreeForData(changedData);\r\n    }\r\n\r\n  }\r\n\r\n  emitAllRows()\r\n  {\r\n    const dataToEmit = JSON.parse(JSON.stringify(this.dataSource.data))\r\n    let allRows = this.getAllChildren(dataToEmit); \r\n    this.emitAllNodes.emit(allRows);\r\n  }\r\n\r\n  getAllChildren(arr)\r\n  {\r\n    let result = [];\r\n    let subResult;\r\n    arr.forEach((item, i) => {\r\n      if (item.children.length>0) {\r\n        subResult = this.getAllChildren(item.children);\r\n        if (subResult) result.push(...subResult);\r\n      }\r\n      result.push(item);\r\n\r\n    });\r\n    return result;\r\n  }\r\n\r\n}\r\n\r\n\r\n","import { NgModule } from '@angular/core';\r\n\r\nimport { FormsModule } from '@angular/forms';\r\nimport { CommonModule } from '@angular/common';\r\nimport { HttpClientModule, HttpClient, HTTP_INTERCEPTORS } from '@angular/common/http';\r\nimport { BrowserAnimationsModule, NoopAnimationsModule } from '@angular/platform-browser/animations';\r\nimport { RouterModule, Routes } from '@angular/router';\r\n\r\n//import * as ol from 'openlayers';\r\nimport { TranslateModule, TranslateLoader, TranslateService } from '@ngx-translate/core';\r\nimport { registerLocaleData } from '@angular/common';\r\nimport { AngularHalModule } from '@sitmun/frontend-core';\r\n\r\n\r\nimport { ReactiveFormsModule } from '@angular/forms';\r\nimport localeCa from '@angular/common/locales/ca';\r\nimport localeEs from '@angular/common/locales/es';\r\nimport { SitmunFrontendCoreModule } from '@sitmun/frontend-core';\r\nimport { DataGridComponent } from './data-grid/data-grid.component';\r\n\r\nimport { AgGridModule } from '@ag-grid-community/angular';\r\n\r\nimport {MaterialModule} from './material-module';\r\n\r\nimport { BtnEditRenderedComponent } from './btn-edit-rendered/btn-edit-rendered.component';\r\nimport { BtnCheckboxRenderedComponent } from './btn-checkbox-rendered/btn-checkbox-rendered.component';\r\nimport { BtnCheckboxFilterComponent } from './btn-checkbox-filter/btn-checkbox-filter.component';\r\nimport { TranslateHttpLoader } from '@ngx-translate/http-loader';\r\nimport { DialogGridComponent } from './dialog-grid/dialog-grid.component';\r\nimport { DialogFormComponent } from './dialog-form/dialog-form.component';\r\nimport { DialogMessageComponent } from './dialog-message/dialog-message.component';\r\nimport { DataTreeComponent } from './data-tree/data-tree.component';\r\n\r\n\r\nregisterLocaleData(localeCa, 'ca');\r\nregisterLocaleData(localeEs, 'es');\r\n\r\n/** Load translation assets */\r\nexport function createTranslateLoader(http: HttpClient) {\r\n  return new TranslateHttpLoader(http, '../assets/i18n/', '.json');\r\n}\r\n\r\n\r\n/** SITMUN plugin core module */\r\n@NgModule({\r\n  imports: [\r\n    RouterModule,\r\n    HttpClientModule,\r\n    CommonModule,\r\n    FormsModule,\r\n    NoopAnimationsModule,\r\n    AngularHalModule,\r\n    ReactiveFormsModule,\r\n    BrowserAnimationsModule,\r\n    AgGridModule,\r\n    SitmunFrontendCoreModule,\r\n    MaterialModule,\r\n    TranslateModule.forRoot({\r\n      loader: {\r\n        provide: TranslateLoader,\r\n        useFactory: (createTranslateLoader),\r\n        deps: [HttpClient]\r\n      }\r\n    })\r\n\r\n  ],\r\n  declarations: [\r\n    DataGridComponent,\r\n    DataTreeComponent,\r\n    BtnEditRenderedComponent,\r\n    BtnCheckboxRenderedComponent,\r\n    BtnCheckboxFilterComponent,\r\n    DialogGridComponent,\r\n    DialogFormComponent,\r\n    DialogMessageComponent,\r\n  ],\r\n  entryComponents: [\r\n  ],\r\n  providers: [\r\n  ],\r\n  exports: [\r\n    HttpClientModule,\r\n    CommonModule,\r\n    FormsModule,\r\n    NoopAnimationsModule,\r\n    AngularHalModule,\r\n    TranslateModule,\r\n    ReactiveFormsModule,\r\n    DataGridComponent,\r\n    DataTreeComponent,\r\n    DialogGridComponent,\r\n    DialogFormComponent,\r\n    DialogMessageComponent,\r\n    SitmunFrontendCoreModule\r\n  ]\r\n})\r\nexport class SitmunFrontendGuiModule {\r\n}\r\n"]}